(()=>{"use strict";function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var i,a;return i=n,a=[{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?document.querySelector(e):t.querySelector(e)}},{key:"findAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?document.querySelectorAll(e):t.querySelectorAll(e)}},{key:"findAllOrNull",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=n.findAll(e,t);return r.length>0?r:null}},{key:"onFirst",value:function(e,t){var r=n.isHTMLElement(e)?e:n.find(e);null!==r&&t(r)}},{key:"onEach",value:function(e,r){var i="string"==typeof e?n.findAll(e):e;if(null!==i){var a,o=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=t(e))){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}(i);try{for(o.s();!(a=o.n()).done;)r(a.value)}catch(e){o.e(e)}finally{o.f()}}}},{key:"isHTMLElement",value:function(e){return 1===(null==e?void 0:e.nodeType)}},{key:"isAudioElement",value:function(e){var t;return n.isHTMLElement(e)&&"audio"===(null===(t=e.nodeName)||void 0===t?void 0:t.toLowerCase())}},{key:"isImgElement",value:function(e){var t;return n.isHTMLElement(e)&&"img"===(null===(t=e.nodeName)||void 0===t?void 0:t.toLowerCase())}},{key:"isPictureElement",value:function(e){var t;return n.isHTMLElement(e)&&"picture"===(null===(t=e.nodeName)||void 0===t?void 0:t.toLowerCase())}},{key:"isImageElement",value:function(e){return n.isImgElement(e)||n.isPictureElement(e)}},{key:"isVideoElement",value:function(e){var t;return n.isHTMLElement(e)&&"video"===(null===(t=e.nodeName)||void 0===t?void 0:t.toLowerCase())}},{key:"isMediaElement",value:function(e){return n.isAudioElement(e)||n.isImageElement(e)||n.isVideoElement(e)}},{key:"updateSrc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n.isHTMLElement(e)?e:n.find(e);n.isImgElement(i)?n.updateImgSrc(i,t):n.isPictureElement(i)?n.updatePictureSrc(i,t,r):n.isAudioElement(i)?n.updateAudioSrc(i,t,r):n.isVideoElement(i)&&n.updateVideoSrc(i,t,r)}},{key:"updateImgSrc",value:function(e,t){e.src!==t&&(e.src=t)}},{key:"updatePictureSrc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n.find(""===r?"source":"source[media='(".concat(r,")']"),e);null!==i&&i.srcset!==t&&(i.srcset=t)}},{key:"updateAudioSrc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Utils.isset(r,!1)||r.startsWith("audio/")){var i=n.find(""===r?"source":"source[type='".concat(r,"']"),e);null!==i&&i.src!==t&&(i.src=t)}}},{key:"updateVideoSrc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Utils.isset(r,!1)||r.startsWith("video/")){var i=n.find(""===r?"source":"source[type='".concat(r,"']"),e);null!==i&&i.src!==t&&(i.src=t)}}},{key:"setVolume",value:function(e,t){var r=n.isHTMLElement(e)?e:n.find(e);(n.isAudioElement(r)||n.isVideoElement(r))&&(r.volume=t/100)}},{key:"addClass",value:function(t,r){n.onEach(t,(function(t){var n;Array.isArray(r)?(n=t.classList).add.apply(n,e(r)):t.classList.add(r)}))}},{key:"removeClass",value:function(t,r){n.onEach(t,(function(t){var n;Array.isArray(r)?(n=t.classList).remove.apply(n,e(r)):t.classList.remove(r)}))}},{key:"swapClass",value:function(e,t,r){n.removeClass(e,t),n.addClass(e,r)}},{key:"setText",value:function(e,t){n.onEach(e,(function(e){e.innerText=t}))}},{key:"setHTML",value:function(e,t){n.onEach(e,(function(e){e.innerHTML=t}))}},{key:"getCSS",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n.isHTMLElement(e)?e:n.find(e);if(!Utils.allset(e,t))return null;if("*"===t)return window.getComputedStyle(i,r);t.includes("-")&&(t=Utils.kebabCaseToCamelCase(t));var a=window.getComputedStyle(i,r);return Utils.isset(a)?a.getPropertyValue(t):null}},{key:"getCSSInt",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n.isHTMLElement(e)?e:n.find(e),a=n.getCSS(i,t,r);return Utils.isset(a)?parseInt(a):null}},{key:"getCSSFloat",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=n.isHTMLElement(e)?e:n.find(e),a=n.getCSS(i,t,r);return Utils.isset(a)?parseFloat(a):null}},{key:"setCSSProp",value:function(e,t,r){n.onEach(e,(function(e){Utils.allset(null==e?void 0:e.style,t)&&(t.includes("-")&&(t=Utils.kebabCaseToCamelCase(t)),e.style[t]=r)}))}},{key:"setCSS",value:function(e,r){n.onEach(e,(function(e){for(var n=0,i=Object.entries(r);n<i.length;n++){var a=(u=i[n],l=2,function(e){if(Array.isArray(e))return e}(u)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(u,l)||t(u,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],s=a[1];Utils.allset(null==e?void 0:e.style,o)&&(o.includes("-")&&(o=Utils.kebabCaseToCamelCase(o)),e.style[o]=s)}var u,l}))}},{key:"hasAttr",value:function(e,t){var r=n.isHTMLElement(e)?e:n.find(e);return Utils.isset(null==r?void 0:r.getAttribute(t))}},{key:"getAttr",value:function(e,t){var r=n.isHTMLElement(e)?e:n.find(e);return null==r?void 0:r.getAttribute(t)}},{key:"setAttr",value:function(e,t,r){n.onEach(e,(function(e){null==e||e.setAttribute(t,r)}))}},{key:"remAttr",value:function(e,t){n.onEach(e,(function(e){null==e||e.removeAttribute(t)}))}},{key:"hasDataAttr",value:function(e,t){var r,i=n.isHTMLElement(e)?e:n.find(e);return Utils.isset(null==i||null===(r=i.dataset)||void 0===r?void 0:r[t],!1)}},{key:"getDataAttr",value:function(e,t){var r,i=n.isHTMLElement(e)?e:n.find(e);return null==i||null===(r=i.dataset)||void 0===r?void 0:r[t]}},{key:"setDataAttr",value:function(e,t,r){(n.isHTMLElement(e)?e:n.find(e)).dataset[t]=r}},{key:"remDataAttr",value:function(e,t){var r=n.isHTMLElement(e)?e:n.find(e);void 0!==(null==r?void 0:r.dataset[t])&&delete r.dataset[t]}}],null&&r(i.prototype,null),a&&r(i,a),n}();function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"isset",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?null!=e&&""!==e:null!=e}},{key:"allset",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];if(!e.isset(o))return!1}return!0}},{key:"resolves",value:function(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(e.split("."));try{for(r.s();!(n=r.n()).done;){var i,a=n.value;if(void 0===(null===(i=t)||void 0===i?void 0:i[a]))return!1;t=t[a]}}catch(e){r.e(e)}finally{r.f()}return!0}},{key:"funcExists",value:function(e){return void 0!==window[e]}},{key:"callFunc",value:function(t){if(e.funcExists(t)){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];(n=window)[t].apply(n,i)}}},{key:"trimSpaces",value:function(t){return e.isset(t)?(a(t)!==string&&(t=t.toString()),t.replace(/\s{2,}/g," ").trim()):""}},{key:"createList",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return(t=e.trimSpaces(t)).split(n)}},{key:"getRandomHexColor",value:function(){return"#".concat(e.getRandomNumber(0,255).toString(16)).concat(e.getRandomNumber(0,255).toString(16)).concat(e.getRandomNumber(0,255).toString(16))}},{key:"getRandomRGBColor",value:function(){return"rgb(".concat(e.getRandomNumber(0,255),", ").concat(e.getRandomNumber(0,255),", ").concat(e.getRandomNumber(0,255),")")}},{key:"getRandomRGBAColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=t>=0&&t<=1?t:1;return"rgba(".concat(e.getRandomNumber(0,255),", ").concat(e.getRandomNumber(0,255),", ").concat(e.getRandomNumber(0,255),", ").concat(n,")")}},{key:"getRandomNumber",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"getRandomDecimal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return parseFloat((Math.random()*(t-e)+e).toFixed(n))}},{key:"getPercentageOf",value:function(e,t){return e>0&&t>0?e/t*100:0}},{key:"divisibleBy",value:function(e,t){return 0!==t&&e%t==0}},{key:"isWholeNumber",value:function(t){return e.divisibleBy(t,1)}},{key:"nextIterator",value:function(e,t){return e<0||t<=0?0:e%t}},{key:"formatTimerValue",value:function(e){return e>=0&&e<10?"0".concat(e):e.toString()}},{key:"isChrome",value:function(){return e.matchesRegex(window.navigator.userAgent,"Chrom(e|ium)","i")}},{key:"getChromeVersion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.matchRegexGroups(window.navigator.userAgent,"Chrom(e|ium)\\/?<version>([0-9]+)","i"),r=n?n[2]:0;return t?r.toString():parseFloat(r)}},{key:"isBrowserSource",value:function(){return e.isset(window.obsstudio)}},{key:"camelCaseToKebabCase",value:function(e){return e.split("").map((function(e,t){return e.toUpperCase()===e?"".concat(t>0?"-":"").concat(e.toLowerCase()):e})).join("")}},{key:"kebabCaseToCamelCase",value:function(e){return e.split("-").map((function(e,t){return t?e.charAt(0).toUpperCase()+item.slice(1).toLowerCase():e})).join("")}},{key:"formatCurrency",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=e.isWholeNumber(t)?0:2;return t.toLocaleString(r,{style:"currency",minimumFractionDigits:i,currency:n})}},{key:"containsText",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!e.allset(t,n)&&(r&&t.includes(n)||t.includes(null==n?void 0:n.toLowerCase()))}},{key:"matchesRegex",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"i";return!!e.allset(t,n)&&new RegExp(n,r).test(t)}},{key:"matchRegexGroups",value:function(e,t){var n=new RegExp(t).exec(this.badgeInfo);return null!=n&&n.groups?n.groups:null}},{key:"resumeSEQueue",value:function(){var e;null===(e=window.SE_API)||void 0===e||e.resumeQueue()}}],null&&s(t.prototype,null),n&&s(t,n),e}();function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=new WeakSet,v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d.add(this),this.badges=t.data.badges,this.badgeInfo=t.data.tags["badge-info"],this.channel=t.data.channel,this.customRewardId=u.isset(t.data.tags["custom-reward-id"])?t.data.tags["custom-reward-id"]:null,this.emotes=t.data.emotes,this.msgId=t.data.msgId,this.raw=t,this.renderedText=t.renderedText,this.roles=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,d,f).call(this),this.text=t.data.text,this.time=new Date(t.data.time),this.userId=t.data.userId,this.username=t.data.displayName}var t,n;return t=e,(n=[{key:"getStats",value:function(){var e=this.text.replace(/\s+/,"").length,t={};return t.wordCount=this.getWordList().length,t.emoteCount=this.emotes.length,t.emotePercentage=u.getPercentageOf(t.emoteCount,t.wordCount),t.capsCount=(this.text.match("/[A-Z]/g")||[]).length,t.capsPercentage=u.getPercentageOf(t.capsCount,e),t.specialCharsCount=(this.text.match("/[^a-zA-Z0-9\\s]/g")||[]).length,t.specialCharsPercentage=u.getPercentageOf(t.specialCharsCount,e),t}},{key:"getDisplayColor",value:function(){return u.isset(this.raw.data.displayColor)?this.raw.data.displayColor:u.getRandomHexColor()}},{key:"hasRole",value:function(e){switch(e){case"broadcaster":case"streamer":return!0===this.roles.broadcaster;case"moderator":case"mod":return!0===this.roles.moderator;case"vip":return!0===this.roles.vip;case"subscriber":case"sub":return!0===this.roles.subscriber;case"staff":return!0===this.roles.staff;default:return!1}}},{key:"isBroadcaster",value:function(){return!0===this.roles.broadcaster}},{key:"isModerator",value:function(){return!0===this.roles.moderator}},{key:"isVIP",value:function(){return!0===this.roles.vip}},{key:"isSubscriber",value:function(){return!0===this.roles.subscriber}},{key:"isStaff",value:function(){return!0===this.roles.staff}},{key:"hasPrimeBadge",value:function(){return this.badges.includes("premium")}},{key:"hasTurboBadge",value:function(){return this.badges.includes("turbo")}},{key:"getTierBadge",value:function(){var e=u.matchRegexGroups(this.raw.tags.badges,"subscriber\\/(?<tier>[20|30])[1-9][0-9]*","");return null!=e&&e.tier?"20"===e.tier?2:"30"===e.tier?3:void 0:1}},{key:"getMonthsSubscribed",value:function(){var e=u.matchRegexGroups(this.badgeInfo,"subscriber\\/(?<months>[1-9][0-9]*)","");return null!=e&&e.months?parseInt(e.months):0}},{key:"getBitsBadge",value:function(){var e=u.matchRegexGroups(this.raw.tags.badges,"bits\\/(?<bits>[1-9][0-9]*)","");return null!=e&&e.bits?parseInt(e.bits):0}},{key:"getGiftsBadge",value:function(){var e=u.matchRegexGroups(this.raw.tags.badges,"sub-gifter\\/(?<gifts>[1-9][0-9]*)","");return null!=e&&e.gifts?parseInt(e.gifts):0}},{key:"isAction",value:function(){return!0===this.raw.data.isAction}},{key:"isCustomReward",value:function(){return u.isset(this.customRewardId)}},{key:"isCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.startsWith("!")?e:"!"+e;return this.text.startsWith(t)}},{key:"getCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isCommand())return null;var t=u.matchRegexGroups(this.text,"!(?<cmd>\\w+)(?<args>[\\s\\w*]*)","i");return null===t?null:e?{command:t.cmd,args:t.args.trim().split(" ")}:t.cmd}},{key:"getWordList",value:function(){return this.text.split(" ")}},{key:"contains",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return u.containsText(this.text,e,t)}},{key:"containsRegex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"i";return u.matchesRegex(this.text,e,t)}},{key:"notOnList",value:function(e){return!1===e.includes(this.username.toLowerCase())}},{key:"hasUsername",value:function(e){return this.username.toLowerCase()===e}},{key:"hasUserId",value:function(e){return this.userId===e}},{key:"usernameContains",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return u.containsText(this.username,e,t)}},{key:"usernameContainsRegex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"i";return u.matchesRegex(this.username,e,t)}}])&&c(t.prototype,n),e}();function f(){var e,t={staff:!1,broadcaster:!1,moderator:!1,vip:!1,subscriber:!1},n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.badges);try{for(n.s();!(e=n.n()).done;)switch(e.value.type){case"broadcaster":t.broadcaster=!0;break;case"moderator":t.moderator=!0;break;case"vip":t.vip=!0;break;case"subscriber":t.subscriber=!0;break;case"staff":t.staff=!0}}catch(e){n.e(e)}finally{n.f()}return t}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,g(e,t,"get"))}function y(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,g(e,t,"set"),n),n}function g(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var p=new WeakMap,b=new WeakMap,k=new WeakMap,w=new WeakMap,S=new WeakMap,E=new WeakMap,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p.set(this,{writable:!0,value:void 0}),b.set(this,{writable:!0,value:void 0}),k.set(this,{writable:!0,value:void 0}),w.set(this,{writable:!0,value:void 0}),S.set(this,{writable:!0,value:void 0}),E.set(this,{writable:!0,value:void 0}),y(this,p,["bot:counter","event:test","event:skip","message","kvstore:update","alertService:toggleSound"]),y(this,b,{}),y(this,k,[]),y(this,w,[]),y(this,S,u.funcExists("onWidgetLoad")),y(this,E,u.funcExists("onSessionUpdate")),this.preflightEventListeners(),this.registerOnWidgetLoad(),this.registerOnSessionUpdate(),this.registerOnEventReceived()}var t,n;return t=e,(n=[{key:"preflightEventListeners",value:function(){for(var e=0,t=[{name:"Subscriber",listener:"subscriber-latest"},{name:"Resub",listener:"subscriber-latest"},{name:"SubGift",listener:"subscriber-latest"},{name:"CommunityGift",listener:"subscriber-latest"},{name:"SubBomb",listener:"subscriber-latest"},{name:"SubBombComplete",listener:"subscriber-latest"},{name:"Tip",listener:"tip-latest"},{name:"Cheer",listener:"cheer-latest"},{name:"Host",listener:"host-latest"},{name:"Raid",listener:"raid-latest"},{name:"Follow",listener:"follower-latest"},{name:"Message",listener:"message"},{name:"DeleteMessage",listener:"delete-message"},{name:"DeleteMessages",listener:"delete-messages"},{name:"EventSkip",listener:"event:skip"},{name:"BotCounter",listener:"bot:counter"},{name:"WidgetButton",listener:"event:test"},{name:"KVStoreUpdate",listener:"kvstore:update"},{name:"ToggleSound",listener:"alertService:toggleSound"}];e<t.length;e++){var n=t[e];u.funcExists("on".concat(n.name))&&(this.expectsEventListener(n.listener)||m(this,k).push(n.listener),m(this,w).push(n.name))}}},{key:"expectsEvents",value:function(){return m(this,w).length>0}},{key:"expectsEventListener",value:function(e){return m(this,k).includes(e)}},{key:"expectsEventName",value:function(e){return m(this,w).includes(e)}},{key:"isSkippable",value:function(e){return m(this,p).includes(e)}},{key:"registerOnWidgetLoad",value:function(){m(this,S)&&window.addEventListener("onWidgetLoad",this.onWidgetLoadHandler.bind(this))}},{key:"unregisterOnWidgetLoad",value:function(){window.removeEventListener("onWidgetLoad",this.onWidgetLoadHandler)}},{key:"registerOnSessionUpdate",value:function(){m(this,E)&&window.addEventListener("onSessionUpdate",this.onSessionUpdateHandler.bind(this))}},{key:"unregisterOnSessionUpdate",value:function(){window.removeEventListener("onSessionUpdate",this.onSessionUpdateHandler)}},{key:"registerOnEventReceived",value:function(){this.expectsEvents()&&window.addEventListener("onEventReceived",this.onEventReceivedHandler.bind(this))}},{key:"unregisterOnEventReceived",value:function(){window.removeEventListener("onEventReceived",this.onEventReceivedHandler)}},{key:"onWidgetLoadHandler",value:function(e){u.callFunc("onWidgetLoad",e)}},{key:"onSessionUpdateHandler",value:function(e){u.callFunc("onSessionUpdate",e)}},{key:"onEventReceivedHandler",value:function(e){var t,n,r=null==e||null===(t=e.detail)||void 0===t?void 0:t.listener,i=null==e||null===(n=e.detail)||void 0===n?void 0:n.event;if(void 0!==r&&void 0!==i&&this.expectsEventListener(r))if(this.expectsEventName("Message")&&"message"===r)this.onMessageHandler(i);else if(this.expectsEventName("DeleteMessage")&&"delete-message"===r)this.onDeleteMessageHandler(i);else if(this.expectsEventName("DeleteMessages")&&"delete-messages"===r)this.onDeleteMessagesHandler(i);else if("subscriber-latest"===r){if(!i.isTest||i.gifted&&i.isCommunityGift||i.bulkGifted||(i.sender=void 0),this.expectsEventName("Subscriber")&&1===i.amount&&void 0===i.sender)this.onSubscriberHandler(i);else if(this.expectsEventName("SubGift")&&i.gifted&&!i.isCommunityGift)this.onSubGiftHandler(i);else if(this.expectsEventName("Resub")&&i.amount>1&&void 0===i.sender)this.onResubHandler(i);else if(this.expectsEventName("SubBomb")&&i.bulkGifted){var a,o=null==i||null===(a=i.sender)||void 0===a?void 0:a.toLowerCase();o&&void 0===m(this,b)[o]&&(m(this,b)[o]={amount:i.amount,recipients:[]}),this.onSubBombHandler(i)}else if(i.gifted&&i.isCommunityGift&&(this.expectsEventName("CommunityGift")&&this.onCommunityGiftHandler(i),this.expectsEventName("SubBombComplete"))){var s,l=null==i||null===(s=i.sender)||void 0===s?void 0:s.toLowerCase();l&&void 0!==m(this,b)[l]&&(m(this,b)[l].recipients.push(i.name),m(this,b)[l].amount===m(this,b)[l].recipients.length?(i.amount=m(this,b)[l].amount,this.onSubBombCompleteHandler(i,m(this,b)[l].recipients),delete m(this,b)[l]):u.resumeSEQueue())}}else this.expectsEventName("Tip")&&"tip-latest"===r?this.onTipHandler(i):this.expectsEventName("Cheer")&&"cheer-latest"===r?this.onCheerHandler(i):this.expectsEventName("Host")&&"host-latest"===r?this.onHostHandler(i):this.expectsEventName("Raid")&&"raid-latest"===r?this.onRaidHandler(i):this.expectsEventName("Follow")&&"follower-latest"===r?this.onFollowHandler(i):this.expectsEventName("BotCounter")&&"bot:counter"===r?this.onBotCounterHandler(i):this.expectsEventName("EventSkip")&&"event:skip"===r?this.onEventSkipHandler(i):this.expectsEventName("WidgetButton")&&"event:test"===r&&"widget-button"===i.listener?this.onWidgetButtonHandler(i):this.expectsEventName("KVStoreUpdate")&&"kvstore:update"===r?this.onKVStoreUpdateHandler(i):this.expectsEventName("ToggleSound")&&"alertService:toggleSound"===r&&this.onToggleSoundHandler(i);else u.resumeSEQueue()}},{key:"onSubscriberHandler",value:function(e){u.callFunc("onSubscriber",e)}},{key:"onResubHandler",value:function(e){u.callFunc("onResub",e)}},{key:"onSubGiftHandler",value:function(e){u.callFunc("onSubGift",e)}},{key:"onCommunityGiftHandler",value:function(e){u.callFunc("onCommunityGift",e)}},{key:"onSubBombHandler",value:function(e){u.callFunc("onSubBomb",e)}},{key:"onSubBombCompleteHandler",value:function(e,t){u.callFunc("onSubBombComplete",e,t)}},{key:"onTipHandler",value:function(e){u.callFunc("onTip",e)}},{key:"onCheerHandler",value:function(e){u.callFunc("onCheer",e)}},{key:"onHostHandler",value:function(e){u.callFunc("onHost",e)}},{key:"onRaidHandler",value:function(e){u.callFunc("onRaid",e)}},{key:"onFollowHandler",value:function(e){u.callFunc("onFollow",e)}},{key:"onMessageHandler",value:function(e){u.callFunc("onMessage",new v(e))}},{key:"onDeleteMessageHandler",value:function(e){u.callFunc("onDeleteMessage",e)}},{key:"onDeleteMessagesHandler",value:function(e){u.callFunc("onDeleteMessages",e)}},{key:"onEventSkipHandler",value:function(){u.callFunc("onEventSkip")}},{key:"onBotCounterHandler",value:function(e){u.callFunc("onBotCounter",e)}},{key:"onWidgetButtonHandler",value:function(e){u.callFunc("onWidgetButton",e)}},{key:"onKVStoreUpdateHandler",value:function(e){u.callFunc("onKVStoreUpdate",e)}},{key:"onToggleSoundHandler",value:function(e){u.callFunc("onToggleSound",e)}}])&&h(t.prototype,n),e}();function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,A(e,t,"get"))}function L(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,A(e,t,"set"),n),n}function A(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var T=new WeakMap,R=new WeakMap,M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T.set(this,{writable:!0,value:void 0}),R.set(this,{writable:!0,value:void 0}),L(this,T,[]),L(this,R,!1)}var t,n;return t=e,(n=[{key:"length",value:function(){return H(this,T).length}},{key:"ready",value:function(){return!1===H(this,R)}},{key:"empty",value:function(){return 0===this.length()}},{key:"indexLength",value:function(){var e=this.length();return e>0?e-1:0}},{key:"add",value:function(e){H(this,T).push(e)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.empty()||H(this,T).splice(e,t)}},{key:"removeFirst",value:function(){this.remove(0)}},{key:"removeLast",value:function(){this.remove(-1)}},{key:"get",value:function(e){return this.empty()?null:e>=0&&e<=this.indexLength()?H(this,T)[e]:e<0&&Math.abs(e)<=this.length()?H(this,T)[this.length()-e]:null}},{key:"first",value:function(){return this.get(0)}},{key:"last",value:function(){return this.get(-1)}},{key:"processFirst",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i,a){var o=t.first();null!==o&&t.ready()&&(L(t,R,!0),e(o).then((function(){setTimeout((function(){t.removeFirst(),L(t,R,!1),r&&u.resumeSEQueue(),i()}),n)})).catch(a))}))}},{key:"processEach",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.processFirst(e,n,r).then((function(){t.processEach(e,n,r)})).catch((function(e){console.error(e)}))}}])&&x(t.prototype,n),e}();window.DOM=i,window.Events=new C,window.Queue=new M,window.Utils=u})();